apiVersion: v1
kind: ConfigMap
metadata:
  name: critical-apps-config
  namespace: kube-system
data:
  critical-apps.yaml: |
    # Multi-App Deterministic Networking Configuration
    # Defines SLA requirements for critical applications and control parameters
    
    critical_apps:
      # Robot control system - highest priority (safety-critical)
      - name: robot-control
        service: robot-control-svc.default.svc.cluster.local
        port: 5201
        protocol: UDP  # UDP is primary for real-time control
        max_jitter_ms: 1.0
        max_latency_ms: 10.0  # Optional hard latency cap
        priority: 100  # Highest priority
        
      # Safety scanner - second priority (safety-critical)
      - name: safety-scanner
        service: safety-scanner-svc.default.svc.cluster.local
        port: 5202
        protocol: TCP  # TCP for safety validation messages
        max_jitter_ms: 2.0
        max_latency_ms: 20.0
        priority: 90
    
    best_effort_targets:
      # Telemetry upload - can be throttled during congestion
      - deployment: telemetry-upload-deployment
        namespace: default
        initial_bandwidth: 100  # Mbps
        
      # ERP dashboard - can be throttled during congestion
      - deployment: erp-dashboard-deployment
        namespace: default
        initial_bandwidth: 100  # Mbps
    
    control:
      probe_interval: 0.5  # Seconds between probes
      control_interval: 2.0  # Seconds between control decisions
      window_size: 20  # Samples for jitter calculation
      
      step_down: 100  # Mbps - aggressive throttle
      step_up: 10     # Mbps - gentle release
      
      min_bandwidth: 10   # Mbps
      max_bandwidth: 1000 # Mbps
    
    severity_multiplier_enabled: true
    severity_max_multiplier: 5.0  # Max 5x throttle on severe violations
